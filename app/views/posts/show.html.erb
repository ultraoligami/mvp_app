<div class="container mt-5">
  <h1><%= @post.title %></h1>

  <p class="text-muted">ジャンル：<%= @post.category %></p>
  <p class="mt-4"><%= simple_format(@post.content) %></p>

  <!-- ▼ 匿名かどうか判定 ▼ -->
  <p class="text-muted">
    投稿者：
    <% if @post.is_anonymous? %>
      匿名さん
    <% else %>
      <%= @post.user.nickname %>
    <% end %>
  </p>
  <!-- ▲ 匿名かどうか判定 ▲ -->

  <p class="text-muted small"><%= l @post.created_at, format: :long %></p>

  <hr>

  <!-- ▼ SNSシェア機能 ▼ -->
  <div class="mt-4">
    <h5>共有する</h5>

    <!-- X (Twitter) -->
    <%= link_to "Xでシェア",
          "https://twitter.com/intent/tweet?text=#{ERB::Util.url_encode(@post.title)}&url=#{post_url(@post)}",
          target: "_blank",
          rel: "noopener",
          class: "btn btn-dark me-2" %>

    <!-- LINE -->
    <%= link_to "LINEで送る",
          "https://social-plugins.line.me/lineit/share?url=#{post_url(@post)}",
          target: "_blank",
          rel: "noopener",
          class: "btn btn-success me-2" %>

    <!-- Facebook -->
    <%= link_to "Facebook",
          "https://www.facebook.com/sharer/sharer.php?u=#{post_url(@post)}",
          target: "_blank",
          rel: "noopener",
          class: "btn btn-primary me-2" %>

    <!-- URLコピー：JS -->
    <button class="btn btn-secondary" onclick="copyPostUrl()">リンクをコピー</button>
  </div>

  <script>
    function copyPostUrl() {
      navigator.clipboard.writeText(window.location.href);
      alert("URLをコピーしました！");
    }
  </script>
  <!-- ▲ SNSシェア機能 ▲ -->

  <% if user_signed_in? && @post.user == current_user %>
    <%= link_to "編集", edit_post_path(@post), class: "btn btn-warning me-2" %>
    <%= button_to "削除", post_path(@post),
      method: :delete,
      form: { class: "d-inline", onsubmit: "return confirm('本当に削除しますか？');" },
      class: "btn btn-danger" %>
  <% end %>

  <%= link_to "一覧に戻る", posts_path, class: "btn btn-secondary mt-3" %>
</div>